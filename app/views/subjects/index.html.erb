<div class="row">
  <div class="col-md-12" style="margin:10px 0;">
    <%= render "shared/search" %>
  </div>
  <div class="col-md-12">
    <%= will_paginate @subjects, renderer: BootstrapPagination::Rails %>
    <%= content_tag :div, class: 'pull-right' do %>
      <% if Subject.parent_types.include?(@type) %>
        <%= link_to sti_subject_path(@type, nil, :new), class: 'btn btn-default' do %>
          <%= fa_icon("plus") %>
          <%= "New #{@type}" %>
        <% end %>
      <% elsif !Subject.child_types.include?(@type) %>
        <div class="btn-group" style="margin-bottom: 10px">
          <button type="button" class="btn btn-default dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
            <%= fa_icon("plus") %> New <span class="caret"></span>
          </button>
          <ul class="dropdown-menu">
            <li><%= link_to 'Monograph', sti_subject_path('Monograph', nil, :new) %></li>
            <li><%= link_to 'Collection', sti_subject_path('Collection', nil, :new) %></li>
            <li><%= link_to 'Issue', sti_subject_path('Issue', nil, :new) %></li>
            <li><%= link_to 'Proceeding', sti_subject_path('Proceeding', nil, :new) %></li>
            <li><%= link_to 'Reference', sti_subject_path('Reference', nil, :new) %></li>
            <li><%= link_to 'Misc', sti_subject_path('Misc', nil, :new) %></li>
          </ul>
        </div>
      <% end %>
    <% end if current_user %>
  </div>
</div>

<table class="table table-bordered table-responsive">
  <thead>
    <tr>
      <th>Citation</th>
      <th>Title <span class="badge pull-right">Total <%= @subjects.count %></span></th>
      <%= content_tag :th, '', style: 'width: 70px;' if current_user %>
    </tr>
  </thead>

  <tbody>
    <% @subjects.each do |subject| %>
      <tr>
        <td>
          <%= link_to "#{subject.cite}", sti_subject_path(subject.type, subject) %><br/>
          <small><%= link_to subject.type, subjects_path(q: "type='#{subject.type}'") %></small>
        </td>
        <td>
          <%= subject.full_entry %>
        </td>
        <%= content_tag :td do %>
          <%= link_to(fa_icon("edit", text: 'edit'), sti_subject_path(subject.type, subject, :edit)) %><br />
          <%= link_to(fa_icon("plus-square-o", text: 'add'), new_subject_path(parent_id: subject.id)) if subject.has_children %>
        <% end if current_user %>

      </tr>
    <% end %>
  </tbody>
</table>

